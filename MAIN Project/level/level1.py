import sys,os
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))
import settings,objects,map_tools,crate,npc,status
from ursina import *

st=status
mt=map_tools
o=objects
c=crate
n=npc
U=-3

def start_load():
	load_crate()
	bonus_zone()
	if 4 in st.COLOR_GEM or settings.debg:
		gem_zone()
	load_object()
	load_wumpa()
	load_npc()

def load_object():
	o.StartRoom(pos=(-.3,1,-66.5))
	TS=16
	cG=color.green
	Sky(color=color.rgb32(40,90,80),texture='res/background/sky.jpg')
	o.Water(pos=(0,.6,0),sca=(10,128),c=color.rgb32(80,80,120),a=1)
	o.InvWall(pos=(-5,.5,-64),sca=(5.,10,200))
	o.InvWall(pos=(4.7,.5,-64),sca=(5.,10,200))
	o.BonusPlatform(pos=(1.4,1,-6))
	o.GemPlatform(pos=(-.3,1.2,-18),t=4)
	gs=1.6
	o.GrassSide(pos=(-4,gs,-47),ry=0)
	o.GrassSide(pos=(-4,gs,-16),ry=0)
	o.GrassSide(pos=(-4,gs,15),ry=0)
	o.GrassSide(pos=(-4,gs,46),ry=0)
	o.GrassSide(pos=(4,gs,-47),ry=180)
	o.GrassSide(pos=(4,gs,-16),ry=180)
	o.GrassSide(pos=(4,gs,15),ry=180)
	o.GrassSide(pos=(4,gs,46),ry=180)
	o.LevelScene(pos=(0,0,128),sca=(350,40,1))
	o.LevelScene(pos=(0,-20,127),sca=(350,40,1))
	#plants
	Entity(model='cube',texture='res/terrain/l1/bricks.png',scale=(9,2,.3),position=(0,-.2,-64.5),texture_scale=(9,2))
	o.TreeScene(pos=(-3.7,1,-63),sca=.0175)
	o.TreeScene(pos=(-4.7,1,-63),sca=.0175)
	o.TreeScene(pos=(3.6,1.2,-63.5),sca=.0175)
	o.TreeScene(pos=(4.6,1.2,-63.5),sca=.0175)
	o.TreeScene(pos=(-1.37,1.5,-46),sca=.0175)
	o.TreeScene(pos=(1.32,1.5,-46),sca=.0175)
	o.TreeScene(pos=(0,1.7,-26.4),sca=.0175)
	o.TreeScene(pos=(-1.4,1.5,10.6),sca=.0175)
	for trw in range(8):
		o.TreeRow(pos=(-4.4,1,-60+trw*12),sca=(.15,.16,.18))
		o.TreeRow(pos=(4.4,1,-60+trw*12),sca=(.15,.16,.18))
	o.Bush(pos=(1.5,1.4,-14.2),sca=2)
	o.Bush(pos=(-1.5,1.4,-14.2),sca=2)
	o.Bush(pos=(-1,1.4,-12),sca=2)
	o.Bush(pos=(1,1.4,-12),sca=2)
	o.Bush(pos=(2.43,1.5,10.7),sca=2)
	o.Bush(pos=(-2,1.5,10.2),sca=2)
	o.TreeScene(pos=(-1.5,1.6,19.3),sca=.0175)
	o.TreeScene(pos=(1.2,1.8,19.3),sca=.0175)
	o.TreeScene(pos=(1.1,1.5,11),sca=.0175)
	o.TreeScene(pos=(.5,1.3,2.5),sca=.0175)
	o.TreeScene(pos=(0,1,-2),sca=.013)
	o.TreeScene(pos=(0,1,6),sca=.013)
	o.Bush(pos=(2.43,1.4,23),sca=3)
	o.Bush(pos=(-2.37,1.4,23),sca=3)
	o.TreeScene(pos=(1,1.6,-34.6),sca=.02)
	o.TreeScene(pos=(-1.4,1.6,-34.6),sca=.02)
	o.TreeScene(pos=(-1.8,1.5,-21.5),sca=.02)
	o.TreeScene(pos=(-1.5,1.5,-60.5),sca=.02)
	o.TreeScene(pos=(1,1.5,-60.5),sca=.02)
	o.TreeScene(pos=(-1.2,1.5,-54.5),sca=.02)
	o.TreeScene(pos=(1.1,1.5,-53),sca=.02)
	#platform grass
	bu_h=.85
	o.Bush(pos=(-1,bu_h,-45.3),sca=(1.2,.8,.1))
	o.Bush(pos=(.7,bu_h,-45.3),sca=(1.2,.8,.1))
	o.Bush(pos=(-1.5,bu_h,-38.61),sca=(1.4,.5,.1))
	o.Bush(pos=(-.6,bu_h,-38.611),sca=(1.4,.5,.1))
	o.Bush(pos=(.5,bu_h,-38.609),sca=(1.4,.5,.1))
	o.Bush(pos=(1.5,bu_h,-38.608),sca=(1.4,.5,.1))
	o.Bush(pos=(-2,.9,-28.55),sca=(1.4,.5,.1))
	o.Bush(pos=(.6,bu_h,-23.1),sca=(1.4,.5,.1))
	o.Bush(pos=(-1.4,bu_h,-16.1),sca=(1.4,.5,.1))
	o.Bush(pos=(-.6,bu_h,-16.11),sca=(1.4,.5,.1))
	o.Bush(pos=(.2,bu_h,-16.12),sca=(1.4,.5,.1))
	o.Bush(pos=(1.2,bu_h,-16.09),sca=(1.6,.5,.1))
	o.Bush(pos=(0,1,-26.37),sca=(2,2,.1))
	o.Bush(pos=(-1,1,-4.12),sca=(1.5,1.5,.1))
	o.Bush(pos=(-2,1,-4.13),sca=(1.5,1.5,.1))
	o.Bush(pos=(1.3,1,-4.13),sca=(1.7,1.5,.1))
	o.Bush(pos=(1.1,1,-57),sca=(2,1.5,.1))
	o.Bush(pos=(-.7,1,-55),sca=(2,1.5,.1))
	o.Bush(pos=(-.8,3,22.75),sca=(2,1.5,.1))
	o.Bush(pos=(.4,3,23),sca=(2,1.5,.1))
	o.Bush(pos=(-.2,3.3,22.8),sca=(2,1.5,.1))
	#platform
	d0=.85
	o.mBlock(pos=(0,d0,-57),sca=(4,24))
	o.mBlock(pos=(0,d0,-36),sca=(4,5))
	o.mBlock(pos=(0,d0,-30),sca=(1,7))
	o.mBlock(pos=(-2,d0,-25),sca=(1,7))
	o.mBlock(pos=(.7,d0,-20),sca=(1,6))
	o.mBlock(pos=(0,d0,-14),sca=(4,4))
	o.mBlock(pos=(0,d0,-9.5),sca=(1,5))
	o.mBlock(pos=(0,d0,-5),sca=(1,4))
	o.mBlock(pos=(1.5,d0,-1.5),sca=(2,5))
	o.mBlock(pos=(1.5,d0,5.7),sca=(2,3))
	o.mBlock(pos=(1.5,d0,9.5),sca=(2,2))
	o.mBlock(pos=(-1.5,d0,-1.5),sca=(2,5))
	o.mBlock(pos=(-1.5,d0,4),sca=(2,3))
	o.mBlock(pos=(-1.5,d0,8.5),sca=(2,3))
	o.mBlock(pos=(0,d0,10),sca=(1,4))
	o.mBlock(pos=(0,d0,18),sca=(4,4))
	o.MossPlatform(p=(0,.5,-44),ptm=0)
	o.MossPlatform(p=(0,.5,-42),ptm=0)
	o.MossPlatform(p=(0,.5,-40),ptm=0)
	o.MossPlatform(p=(-2,.5,-6),ptm=0)
	o.MossPlatform(p=(0,.5,13.5),ptm=0)
	o.MossPlatform(p=(0,.5,15),ptm=0)
	o.Corridor(pos=(0,.975,-13))
	o.EndRoom(pos=(1,2.4,28.2),c=color.rgb32(160,180,160))
def load_crate():
	CRP=1.16
	if not 4 in st.COLOR_GEM:
		c.place_crate(ID=16,p=(-.3,CRP,-58))
	mt.crate_plane(ID=2,POS=(-1.8,CRP,3.3),CNT=[2,1])
	mt.crate_wall(ID=14,POS=(-1.3,1.14,8.8),CNT=[2,2])
	mt.crate_plane(ID=1,POS=(-1.5,CRP,-2.5),CNT=[1,3])
	mt.crate_wall(ID=14,POS=(1,CRP,-56.5),CNT=[1,2])
	mt.crate_wall(ID=1,POS=(-1,CRP,-49),CNT=[2,1])
	c.place_crate(ID=5,p=(0,CRP,-54))
	mt.bounce_twin(POS=(1,CRP,-36),CNT=1)
	mt.crate_row(ID=1,POS=(-1.3,.9,-22.3),CNT=5,WAY=0)
	c.place_crate(ID=9,m=1,l=0,p=(-1.3,.9,-22.82))
	for aE in range(4):
		c.place_crate(ID=13,m=1,l=0,p=(-.98+.32*aE,.9,-22.82))
	mt.crate_row(ID=1,POS=(-1.3,.9,-27.5),CNT=3,WAY=0)
	mt.crate_row(ID=1,POS=(1.8,.8,1.1),CNT=10,WAY=1)
	mt.crate_row(ID=0,POS=(-.1,.8,20.16),CNT=10,WAY=1)
	c.place_crate(ID=4,p=(.9,CRP,-3.9))
	c.place_crate(ID=3,m=1,l=0,p=(-2,CRP,-6))
	mt.crate_wall(ID=1,POS=(-1.09,CRP,17),CNT=[1,2])
	mt.bounce_twin(POS=(1.1,CRP,18),CNT=1)
	#checkpoints
	c.place_crate(ID=6,p=(0,CRP,-46))
	c.place_crate(ID=6,p=(.6,CRP,-17.8))
	c.place_crate(ID=6,p=(0,CRP,11.1))
	#crates gem route
	mt.crate_wall(ID=1,POS=(199.3,.29,-3.7),CNT=[1,2])
	mt.crate_plane(ID=1,POS=(200.3,3.29-.32,32.3),CNT=[2,2])
	mt.crate_plane(ID=11,POS=(201,3.29-.32,35.3),CNT=[2,1])
	mt.crate_plane(ID=1,POS=(200.6,3.29-.32,38.3),CNT=[2,2])
	mt.bounce_twin(POS=(200.9,3.29,28),CNT=1)
	mt.crate_plane(ID=11,POS=(200,1.26-.32,7.8),CNT=[1,1])
	c.place_crate(ID=9,p=(203.3,3.29-.32,37),m=121)
	mt.crate_plane(ID=3,POS=(200,1.26-.32,9.8),CNT=[1,1])
	c.place_crate(ID=5,p=(200,1.28,16.2))
	mt.crate_plane(ID=1,POS=(199,1.28,20.2),CNT=[1,2])
	mt.crate_plane(ID=1,POS=(200.9,2.29,24.7),CNT=[1,3])
	mt.crate_wall(ID=2,POS=(202.9,3.29,50.3),CNT=[2,2])
	mt.bounce_twin(POS=(201,3.29,50.9),CNT=1)
	for cr_x in range(3):
		for cr_z in range(5):
			c.place_crate(ID=13,p=(201+cr_x/1.1,3.3,42+cr_z*1.2),m=121,l=11)
	o.mBlock(pos=(202,3,50),sca=(3,4))
	c.place_crate(ID=8,p=(200,1.125+.16,22.14))
	c.place_crate(ID=8,p=(200,2.125+.16,27))
def load_wumpa():
	wu_h=1.3
	mt.wumpa_plane(POS=(-.2,wu_h,-56.1),CNT=[2,3])
	mt.wumpa_plane(POS=(-.1,wu_h,-50),CNT=[2,3])
	mt.wumpa_row(POS=(0,wu_h,-44),CNT=3,WAY=2)
	mt.wumpa_row(POS=(0,wu_h,-40),CNT=3,WAY=2)
	mt.wumpa_plane(POS=(-.2,wu_h,-36.5),CNT=[2,3])
	mt.wumpa_row(POS=(0,wu_h,-33),CNT=6,WAY=1)
	mt.wumpa_row(POS=(-2,wu_h,-27),CNT=5,WAY=1)
	mt.wumpa_row(POS=(.6,wu_h,-22),CNT=5,WAY=1)
	mt.wumpa_plane(POS=(0,wu_h,-9),CNT=[1,3])
	mt.wumpa_plane(POS=(0,wu_h,-6),CNT=[1,3])
	mt.wumpa_plane(POS=(1.6,wu_h,-1.5),CNT=[1,3])
	mt.wumpa_plane(POS=(0,wu_h,16.3),CNT=[1,3])
def load_npc():
	n.spawn(ID=0,POS=(0,1.1,-52))
	n.spawn(ID=0,POS=(0,1.1,-38))
	n.spawn(ID=1,POS=(0,1.1,-15))

## bonus level / gem path
def bonus_zone():
	o.BonusPlatform(pos=(11.8,-36.7,U))
	o.Water(pos=(0,-38.5,0),sca=(60,60),c=color.rgb32(100,110,110),a=.9)
	Entity(model='plane',scale=70,position=(0,-40,0),color=color.black)
	for w in range(2):
		o.BackgroundWall(p=(0+w*14,-37,2))
	o.mBlock(pos=(.35,-37,U),sca=(3,.5))
	o.mBlock(pos=(4,-37,U),sca=(2,.5))
	o.mBlock(pos=(6.7,-37,U),sca=(2,.5))
	o.mBlock(pos=(10,-37,U),sca=(2.5,.5))
	c.place_crate(ID=8,p=(4,-36.66,U))
	mt.crate_row(ID=1,POS=(4,-34,U),WAY=2,CNT=4)
	mt.crate_wall(ID=1,POS=(1,-36.72,U),CNT=[1,3])
	mt.crate_wall(ID=2,POS=(6,-36.72,U),CNT=[2,2])
	mt.bounce_twin(POS=(10.9,-36.72,U),CNT=1)
	c.place_crate(ID=4,p=(9,-36.72,U))
	mt.wumpa_row(POS=(9,-36,U),CNT=4,WAY=2)
	mt.wumpa_row(POS=(9.4,-36.72,U),CNT=4,WAY=0)
	mt.wumpa_row(POS=(2,-36,U),CNT=3,WAY=0)
def gem_zone():
	o.LevelScene(pos=(200,0,128),sca=(200,40,1))
	o.LevelScene(pos=(200,-20,127),sca=(200,40,1))
	o.Water(pos=(200,-.1,10),sca=(8,50),c=color.rgb32(80,80,120),a=1)
	o.Water(pos=(200,2.3,50),sca=(16,40),c=color.rgb32(80,80,120),a=1)
	o.FallingZone(pos=(200,-4,0),s=(40,1,32))
	o.mBlock(pos=(200,0,-3),sca=(2,4))
	o.mBlock(pos=(200,0,1),sca=(1,1))
	o.mBlock(pos=(200,.5,3),sca=(1,1))
	o.mBlock(pos=(200,1,5),sca=(1,1))
	o.MossPlatform(p=(200,.6,7),ptm=0)
	o.MossPlatform(p=(200,.6,9),ptm=0)
	o.MossPlatform(p=(200,.6,11),ptm=0)
	o.mBlock(pos=(200,1,15),sca=(1,5))
	o.mBlock(pos=(200,1,20),sca=(3,5))
	o.mBlock(pos=(200,2,25),sca=(3,5))
	o.mBlock(pos=(200,3,28),sca=(3,1))
	o.mBlock(pos=(200,3,29),sca=(1,1))
	o.mBlock(pos=(200,3,30),sca=(1,1))
	o.mBlock(pos=(200,3,31),sca=(1,1))
	o.mBlock(pos=(201,3,31),sca=(1,1))
	o.mBlock(pos=(202,3,31),sca=(1,1))
	o.mBlock(pos=(202,3,32),sca=(1,1))
	o.mBlock(pos=(202,3,33),sca=(1,1))
	o.mBlock(pos=(202,3,34),sca=(1,1))
	o.mBlock(pos=(201,3,34),sca=(1,1))
	o.mBlock(pos=(200,3,34),sca=(1,1))
	o.mBlock(pos=(200,3,35),sca=(1,1))
	o.mBlock(pos=(200,3,36),sca=(1,1))
	o.mBlock(pos=(200,3,37),sca=(1,1))
	o.mBlock(pos=(201,3,37),sca=(1,1))
	o.mBlock(pos=(202,3,37),sca=(1,1))
	o.mBlock(pos=(202,3,38),sca=(1,1))
	o.mBlock(pos=(202,3,39),sca=(1,1))
	o.mBlock(pos=(202,3,40),sca=(1,1))
	o.mBlock(pos=(202,3,41),sca=(1,1))
	for mos_x in range(3):
		for mos_z in range(5):
			o.MossPlatform(p=(201+mos_x/1.1,2.6,42+mos_z*1.2),ptm=random.randint(0,1))
	#decoration
	o.TempleWall(pos=(197.5,-.5,15.5),sd=2)
	o.TempleWall(pos=(202.5,-.5,15.5),sd=1)
	o.TempleWall(pos=(197.5,0,19),sd=2)
	o.TempleWall(pos=(202.5,0,19),sd=1)
	o.TempleWall(pos=(197.5,.5,23),sd=2)
	o.TempleWall(pos=(202.5,.5,23),sd=1)
	o.TempleWall(pos=(197.5,1,27),sd=2)
	o.TempleWall(pos=(202.5,1,27),sd=1)
	o.TempleWall(pos=(198,1.5,31),sd=2)
	o.TempleWall(pos=(203.5,1.5,31),sd=1)
	o.TempleWall(pos=(198,1.5,35),sd=2)
	o.TempleWall(pos=(198,1.5,39),sd=2)
	o.TempleWall(pos=(199.5,1.5,62),sd=2)
	o.TempleWall(pos=(204.8,1.5,61),sd=1)
	#trees
	o.TreeScene(pos=(202.7,3.725,51.7),sca=.0175)
	for tr in range(2):
		o.TreeRow(pos=(195,.7,-7+tr*12),sca=(.15,.16,.18))
		o.TreeRow(pos=(205,.7,-7+tr*12),sca=(.15,.16,.18))
	#bush
	o.Bush(pos=(198.7,0,17.45),sca=1.5)
	o.Bush(pos=(197.8,0,17.44),sca=1.5)
	o.Bush(pos=(201,0,17.45),sca=1.5)
	o.Bush(pos=(202,0,17.44),sca=1.5)
	o.Bush(pos=(199,2.3,29.4),sca=1.5)
	o.Bush(pos=(201,2.3,29.4),sca=1.5)
	o.Bush(pos=(202,2.3,29.41),sca=1.5)
	o.Bush(pos=(199,1.5,29.),sca=1.5)
	o.Bush(pos=(201,1.5,29.),sca=1.5)
	o.Bush(pos=(202,1.5,29.01),sca=1.5)
	o.Bush(pos=(199.1,2,39.7),sca=2)
	o.Bush(pos=(199.1,3,39.72),sca=2)
	#grass
	o.GrassSide(pos=(197.5,.9,0),ry=0)
	o.GrassSide(pos=(202.5,.9,0),ry=180)
	o.GrassSide(pos=(199,3.3,55.1),ry=0)
	o.GrassSide(pos=(205,3.3,47),ry=180)
	#wumpa
	mt.wumpa_row(POS=(200,1.32,12.9),CNT=4,WAY=1)
	mt.wumpa_row(POS=(200,3.33,28.8),CNT=3,WAY=1)
	mt.wumpa_row(POS=(202,3.33,31.3),CNT=4,WAY=1)
	mt.wumpa_row(POS=(200,3.33,34.3),CNT=3,WAY=1)
	mt.wumpa_row(POS=(202,3.33,37),CNT=6,WAY=1)
	mt.wumpa_row(POS=(200.0,3.33,30.9),CNT=3,WAY=0)
	mt.wumpa_row(POS=(200.0,3.33,33.9),CNT=3,WAY=0)
	mt.wumpa_row(POS=(200.4,3.33,36.9),CNT=3,WAY=0)
	mt.wumpa_plane(POS=(200.7,.33,-4.7),CNT=[1,3])
	mt.wumpa_plane(POS=(199.8,.33,.7),CNT=[2,2])
	mt.wumpa_plane(POS=(199.8,.82,2.7),CNT=[2,2])
	mt.wumpa_plane(POS=(199.8,1.32,4.7),CNT=[2,2])
	mt.wumpa_plane(POS=(200,1.32,18.1),CNT=[2,5])
	mt.wumpa_plane(POS=(199,2.33,23),CNT=[2,5])
	mt.wumpa_plane(POS=(201,3.33,48.5),CNT=[4,3])
	#npc
	n.spawn(ID=1,POS=(200,1.125,18.565),DRC=0)
	n.spawn(ID=2,POS=(200,2.125,24.3),DRC=0)
	n.spawn(ID=2,POS=(201.15,3.125,31),DRC=0)
	n.spawn(ID=1,POS=(201,3.125,34),DRC=0)
	n.spawn(ID=2,POS=(202,3.125,38.8587),DRC=2)
	o.GemPlatform(pos=(202,3.3,51.2),t=4)